<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
      /* =========================================
         1. Global Variables & Body
         ========================================= */
      :root {
        --primary-color: #4a90e2;
        --bg-color: #f4f7f6;
        --text-color: #333;
      }

      body {
        font-family: 'Sarabun', sans-serif;
        background-color: var(--bg-color);
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
        padding-top: 0;
      }

      /* =========================================
         2. Navbar (‡πÅ‡∏ñ‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ö‡∏ô)
         ========================================= */
      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        padding: 0 25px;
        background-color: #fff;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        box-sizing: border-box;
        height: 70px; /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô Desktop */
      }

      /* Logo Area */
      .nav-left { flex: 0 0 auto; padding-left: 10px; }

      /* Wrapper ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏¢‡πà‡∏≠/‡∏Ç‡∏¢‡∏≤‡∏¢ (Center + Right) */
      .nav-collapsible {
        display: flex;
        flex: 1;
        justify-content: space-between;
        align-items: center;
      }

      .nav-center {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 40px;
        flex: 1; 
      }
      
      .nav-right {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        gap: 15px;
        padding-right: 10px;
      }

      .pyh-logo {
        font-size: 32px;
        font-weight: 800;
        letter-spacing: 1px;
        background: linear-gradient(135deg, #20a497 0%, #55c2b4 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        display: inline-block;
      }

      .nav-link {
        color: #777;
        font-weight: 600;
        font-size: 16px;
        padding: 10px 20px;
        border-radius: 8px;
        transition: 0.2s;
        cursor: pointer;
        user-select: none;
        text-align: center;
        display: inline-block;
      }

      .nav-link:hover, .nav-link.active {
        color: var(--primary-color);
        background-color: #eef6fc;
      }

      /* Hamburger Icon (Desktop: Hide) */
      .hamburger {
        display: none;
        cursor: pointer;
        flex-direction: column;
        justify-content: center;
        gap: 6px;
        width: 30px;
        height: 30px;
        z-index: 1001;
        padding: 0;
        background: transparent;
        border: none;
      }
      .hamburger span {
        display: block;
        width: 100%;
        height: 3px;
        background-color: #444;
        border-radius: 3px;
        transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
      }

      /* User Profile Display */
      #user-info-display {
        text-align: right;
        font-size: 14px;
        line-height: 1.2;
        color: #555;
      }
      #current-user { display: block; font-weight: bold; color: #333; }
      #current-role { font-size: 12px; color: #888; }

      /* Logout Button */
      button.logout-btn {
        background-color: transparent;
        border: 1px solid #ff4d4d;
        color: #ff4d4d;
        padding: 8px 15px;
        font-size: 14px;
        cursor: pointer;
        border-radius: 6px;
        transition: 0.2s;
      }
      button.logout-btn:hover {
        background-color: #ff4d4d;
        color: white;
      }

      /* Language Toggle Button */
      .lang-btn {
        background: #fff;
        border: 1px solid #e1e5ea;
        color: #666;
        font-family: 'Sarabun', sans-serif;
        font-size: 13px;
        font-weight: 700;
        border-radius: 30px;
        padding: 8px 15px;
        cursor: pointer;
        margin-right: 10px;
        min-width: 80px;
        text-align: center;
        transition: 0.2s;
      }
      .lang-btn:hover {
        color: #20a497;
        border-color: #20a497;
        background: #f0fcfb;
      }

      /* =========================================
         3. Containers
         ========================================= */
      .container {
        background: white;
        padding: 40px 35px;
        border-radius: 15px;
        border-top: 5px solid #20a497;
        box-shadow: 0 10px 40px rgba(0,0,0,0.08);
        width: 100%;
        max-width: 380px;
        text-align: center;
        box-sizing: border-box;
        transition: max-width 0.3s ease;
      }

      .settings-card {
        background: white;
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 5px 30px rgba(0,0,0,0.08);
        width: 95%;
        max-width: 900px;
        box-sizing: border-box;
        margin: auto;
        animation: fadeIn 0.5s;
        text-align: center;
      }
      .settings-card table { width: 100%; }

      /* =========================================
         4. Login Section
         ========================================= */
      .login-header { margin-bottom: 35px; }
      .login-brand {
        font-family: 'Sarabun', sans-serif;
        font-size: 48px;
        font-weight: 800;
        line-height: 1;
        margin-bottom: 10px;
        background: linear-gradient(135deg, #18bca2 0%, #20a497 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        display: inline-block;
      }
      .login-subtitle {
        color: #a0a0a0;
        font-size: 11px;
        font-weight: 600;
        letter-spacing: 1.5px;
        text-transform: uppercase;
      }

      .input-group-icon { position: relative; margin-bottom: 20px; }
      .input-group-icon input {
        width: 100%;
        padding: 12px 15px 12px 45px;
        border: 1px solid #e1e5ea;
        border-radius: 6px;
        font-size: 14px;
        color: #555;
        font-family: 'Sarabun', sans-serif;
        box-sizing: border-box;
      }
      .input-group-icon input:focus { border-color: #20a497; outline: none; }
      
      .icon-user, .icon-lock {
        position: absolute; top: 50%; left: 15px; transform: translateY(-50%);
        width: 18px; height: 18px; opacity: 0.4;
        background-repeat: no-repeat; background-position: center;
      }
      .icon-user { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E"); }
      .icon-lock { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23555'%3E%3Cpath d='M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z'/%3E%3C/svg%3E"); }

      .btn-gradient {
        background: linear-gradient(90deg, #2563eb 0%, #15b8a6 100%);
        color: white; border: none; padding: 12px; border-radius: 6px;
        font-size: 16px; font-weight: 600; cursor: pointer; width: 100%;
        margin-top: 10px; transition: 0.3s; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
      }
      .btn-gradient:hover { opacity: 0.9; transform: translateY(-1px); }

      /* =========================================
         5. Survey Form
         ========================================= */
      h2 { color: #333; margin-bottom: 10px; }

      .survey-subtitle {
        color: #888;           /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤ */
        font-size: 13px;       /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å */
        text-align: center;
        margin-top: 0;
        margin-bottom: 25px;   /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
        line-height: 1.5;
        font-weight: 400;
      }

      .satisfaction-subtitle {
        color: #888;
        font-size: 12px;       /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å */
        text-align: center;
        margin-top: 5px;     /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡∏ä‡∏¥‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
        margin-bottom: 20px;   /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß Emoji ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
        font-weight: 400;
        line-height: 1.4;
      }

      .input-group { margin-bottom: 15px; text-align: left; }
      label { font-weight: 600; display: block; margin-bottom: 5px; color: #555; }
      
      select, textarea, .readonly-field, #contact {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;      /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡∏°‡∏ô */
        font-family: 'Sarabun', sans-serif;
        box-sizing: border-box;
        margin-top: 10px;        /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
        outline: none;
        transition: all 0.3s;    /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏π‡∏ó */
      }

      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏µ‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å (Focus) ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô */
      /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (Other) */
      #other-specify {
        width: 100%;                  /* ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà */
        padding: 12px 15px;           /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πà‡∏á ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏á‡πà‡∏≤‡∏¢ */
        margin-top: 12px;             /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô */
        
        background-color: #fcfcfc;    /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≤‡∏ß‡∏≠‡∏°‡πÄ‡∏ó‡∏≤‡∏ô‡∏¥‡∏î‡πÜ ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
        border: 1px solid #e1e5ea;    /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô ‡∏™‡∏ö‡∏≤‡∏¢‡∏ï‡∏≤ */
        border-radius: 10px;          /* ‡∏Ç‡∏≠‡∏ö‡∏°‡∏ô‡πÇ‡∏Ñ‡πâ‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
        
        font-family: 'Sarabun', sans-serif;
        font-size: 14px;
        color: #333;
        
        box-sizing: border-box;       /* ‡∏à‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏ô */
        transition: all 0.3s ease;    /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏™‡∏°‡∏π‡∏ó‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏ä‡∏µ‡πâ */
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.03); /* ‡πÄ‡∏á‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏à‡∏≤‡∏á‡πÜ */
        
        /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô (‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') */
        display: none; 
      }

      /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå (Focus) */
      #other-specify:focus {
        background-color: #ffffff;    /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡∏™‡∏ß‡πà‡∏≤‡∏á */
        border-color: #20a497;        /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ò‡∏µ‡∏°‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß) */
        box-shadow: 0 4px 12px rgba(32, 164, 151, 0.15); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡∏ü‡∏∏‡πâ‡∏á‡πÜ ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
        outline: none;                /* ‡∏•‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å */
        transform: translateY(-1px);  /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏•‡∏≠‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á */
      }
      
      /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ (Hover) */
      #other-specify:hover {
        border-color: #b0b8c1;
      }

      /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ Contact */
      .contact-subtitle {
        color: #888;
        font-size: 13px;
        margin-top: -3px;
        margin-bottom: 15px;
        font-weight: 400;
        line-height: 1.4;
      }

      /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á 4 ‡∏ä‡πà‡∏≠‡∏á */
      .contact-input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-family: 'Sarabun', sans-serif;
        box-sizing: border-box;
        margin-bottom: 10px; /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á */
        outline: none;
        transition: all 0.3s;
      }
      .contact-input:focus {
        border-color: #20a497;
        box-shadow: 0 0 5px rgba(32, 164, 151, 0.2);
      }

      .readonly-field { background-color: #e9ecef; cursor: not-allowed; color: #666; }

      button#btn-submit {
        background: linear-gradient(135deg, #20a497 0%, #15b8a6 100%);
        color: white; border: none; padding: 14px 20px;
        font-size: 16px; font-weight: 700; font-family: 'Sarabun', sans-serif;
        letter-spacing: 1px; border-radius: 50px; cursor: pointer; width: 100%;
        margin-top: 25px; box-shadow: 0 10px 25px rgba(32, 164, 151, 0.4);
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      }
      button#btn-submit:hover {
        background: linear-gradient(135deg, #25cbbd 0%, #18bca2 100%);
        transform: translateY(-3px); box-shadow: 0 15px 35px rgba(32, 164, 151, 0.5);
      }
      button#btn-submit:active { transform: translateY(-1px); box-shadow: 0 5px 15px rgba(32, 164, 151, 0.4); }
      button#btn-submit:disabled { background: #ccc; box-shadow: none; cursor: not-allowed; transform: none; }

      .emoji-container { display: flex; justify-content: space-between; margin-bottom: 20px; }
      .emoji-item { font-size: 35px; cursor: pointer; transition: transform 0.2s; opacity: 0.5; filter: grayscale(100%); }
      .emoji-item:hover { transform: scale(1.2); }
      .emoji-item.active { opacity: 1; filter: grayscale(0%); transform: scale(1.3); }
      .emoji-label { font-size: 12px; margin-top: 5px; color: #666; }

      /* =========================================
         6. Tables
         ========================================= */
      #history-section { display: none; width: 100%; animation: fadeIn 0.5s; }
      .history-table {
        width: 100%; border-collapse: collapse; margin-top: 20px;
        background-color: white; box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        border-radius: 8px; overflow: hidden; table-layout: fixed;
      }
      .history-table th, .history-table td {
        padding: 12px 15px; text-align: left; border-bottom: 1px solid #eee; font-size: 14px;
      }
      .history-table th { background-color: #20a497; color: white; font-weight: 600; white-space: nowrap; }
      .history-table tr:hover { background-color: #f9f9f9; }
      .no-data { text-align: center; padding: 20px; color: #888; font-style: italic; }

      .settings-card .history-table th:nth-child(1) { width: 25%; }
      .settings-card .history-table th:nth-child(2) { width: 30%; }
      .settings-card .history-table th:nth-child(3) { width: 20%; }
      .settings-card .history-table th:nth-child(4) { width: 25%; }

      /* =========================================
         7. Settings & User Management
         ========================================= */
      .settings-header-box { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
      .btn-add-user {
        background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%);
        color: white; border: none; padding: 10px 20px; border-radius: 30px;
        font-size: 14px; font-weight: bold; cursor: pointer;
        box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3); transition: 0.3s;
        display: flex; align-items: center; gap: 5px; min-width: 160px; justify-content: center;
      }
      .btn-add-user:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(76, 175, 80, 0.4); }

      .action-btn {
        padding: 5px 10px; border-radius: 6px; border: none;
        cursor: pointer; font-size: 12px; font-weight: 600;
        margin: 0 2px; color: white; transition: 0.2s;
      }
      .btn-edit { background-color: #ff9800; } .btn-edit:hover { background-color: #f57c00; }
      .btn-delete { background-color: #f44336; } .btn-delete:hover { background-color: #d32f2f; }
      
      .form-row { margin-bottom: 15px; text-align: left; }
      .form-row label { display: block; font-size: 14px; color: #666; margin-bottom: 5px; font-weight: 600; }
      .form-row input, .form-row select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-family: 'Sarabun'; }

      /* =========================================
         8. Modals
         ========================================= */
      .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-color: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center;
        z-index: 2000; animation: fadeIn 0.3s;
      }
      .modal-box {
        background: white; padding: 40px 60px; border-radius: 15px; text-align: center;
        box-shadow: 0 5px 30px rgba(0,0,0,0.2); animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .modal-box h3 { margin: 20px 0 0 0; color: #555; font-size: 28px; font-weight: 600; font-family: 'Sarabun', sans-serif; }

      .success-icon-ring { width: 80px; height: 80px; border-radius: 50%; border: 4px solid #4CAF50; display: inline-flex; justify-content: center; align-items: center; background-color: #fff; }
      .checkmark { width: 56px; height: 56px; border-radius: 50%; display: block; stroke-width: 4; stroke: #4CAF50; stroke-miterlimit: 10; animation: fill .4s ease-in-out .4s forwards, scale .3s ease-in-out .9s both; }
      .checkmark__circle { stroke-dasharray: 166; stroke-dashoffset: 166; stroke-width: 2; stroke-miterlimit: 10; stroke: #4CAF50; fill: none; animation: stroke 0.6s cubic-bezier(0.65, 0, 0.45, 1) forwards; }
      .checkmark__check { transform-origin: 50% 50%; stroke-dasharray: 48; stroke-dashoffset: 48; animation: stroke 0.3s cubic-bezier(0.65, 0, 0.45, 1) 0.8s forwards; }

      .warning-icon-ring { width: 80px; height: 80px; border-radius: 50%; border: 4px solid #ff9800; display: inline-flex; justify-content: center; align-items: center; background-color: #fff; margin-bottom: 15px; box-shadow: 0 4px 15px rgba(255, 152, 0, 0.2); animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
      .warning-mark { font-size: 50px; font-weight: bold; color: #ff9800; font-family: sans-serif; margin-top: -5px; }

      .btn-modal-ok { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; border: none; padding: 10px 30px; border-radius: 50px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 20px; box-shadow: 0 4px 10px rgba(245, 124, 0, 0.3); font-family: 'Sarabun', sans-serif; transition: 0.2s; }
      .btn-modal-ok:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(245, 124, 0, 0.4); }
      
      .btn-modal-delete { background: linear-gradient(135deg, #ff5252 0%, #f44336 100%); color: white; border: none; padding: 10px 30px; border-radius: 50px; font-size: 16px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 10px rgba(244, 67, 54, 0.3); transition: 0.2s; font-family: 'Sarabun', sans-serif; }
      .btn-modal-delete:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(244, 67, 54, 0.4); }
      .btn-modal-cancel { background: #f0f0f0; color: #666; border: 1px solid #ddd; padding: 10px 30px; border-radius: 50px; font-size: 16px; font-weight: 600; cursor: pointer; font-family: 'Sarabun', sans-serif; transition: 0.2s; }
      .btn-modal-cancel:hover { background: #e0e0e0; color: #333; }

      @keyframes stroke { 100% { stroke-dashoffset: 0; } }
      @keyframes scaleUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

      /* =========================================
         9. MEDIA QUERIES (Mobile & Desktop)
         ========================================= */

      /* ----- Mobile (Phone / Portrait) ----- */
      /* ‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö ‡∏û‡∏≠‡∏î‡∏µ‡∏à‡∏≠ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞ */
      @media screen and (max-width: 768px) {
        /* Navbar ‡πÄ‡∏ï‡∏µ‡πâ‡∏¢‡∏•‡∏á */
        .navbar {
          padding: 0 15px;
          height: 60px;
          justify-content: space-between;
        }

        .pyh-logo { font-size: 24px; }
        .nav-left { display: flex; align-items: center; padding-left: 0; }

        /* Hamburger Show */
        .hamburger {
          display: flex;
          margin-left: auto;
          transform: scale(0.9);
        }

        /* ‡πÄ‡∏°‡∏ô‡∏π Collapsible */
        .nav-collapsible {
          display: none;
          position: fixed;
          top: 60px; /* ‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å Navbar */
          left: 0;
          width: 100%;
          background: white;
          flex-direction: column;
          align-items: center;
          padding: 10px 0;
          box-shadow: 0 10px 20px rgba(0,0,0,0.1);
          z-index: 999;
          border-bottom: 1px solid #f0f0f0;
          animation: slideDown 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        .nav-collapsible.active { display: flex; }

        /* Links in Mobile */
        .nav-center {
          flex-direction: column;
          gap: 0;
          width: 100%;
        }
        .nav-link {
          width: 100%;
          padding: 15px 0;
          border-bottom: 1px solid #f5f5f5;
          border-radius: 0;
        }

        /* User Info in Mobile */
        .nav-right {
          flex-direction: column;
          width: 100%;
          gap: 15px;
          margin-top: 15px;
          padding: 0 0 10px 0;
        }
        #user-info-display { margin-bottom: 5px; }

        /* Animation */
        .hamburger.open span:nth-child(1) { transform: rotate(45deg) translate(5px, 6px); background-color: #ff4d4d; }
        .hamburger.open span:nth-child(2) { opacity: 0; }
        .hamburger.open span:nth-child(3) { transform: rotate(-45deg) translate(5px, -6px); background-color: #ff4d4d; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Body & Container Adjustments (FIT SCREEN) --- */
        body {
          display: block;
          padding-top: 0 !important;
          height: auto !important;
          overflow-y: auto !important;
          background-color: #f0f2f5;
        }

        .container {
          width: 96% !important;
          max-width: 100% !important;
          /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á: ‡∏ö‡∏ô 75px (‡∏û‡πâ‡∏ô Navbar) / ‡∏•‡πà‡∏≤‡∏á 20px / ‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤ auto */
          margin: 75px auto 20px auto !important; 
          padding: 15px;
          border-radius: 12px;
        }

        .settings-card {
          width: 98%;
          padding: 15px 5px;
          margin-top: 75px !important;
        }

        /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö */
        h2 { font-size: 18px; margin-bottom: 10px; margin-top: 0; }
        .input-group { margin-bottom: 8px; }
        label { font-size: 13px; margin-bottom: 2px; }
        input, select, textarea, .readonly-field {
          padding: 8px 10px;
          font-size: 14px;
          height: auto;
        }
        textarea#suggestion { height: 60px; }
        
        /* Emoji Compact */
        .emoji-container { margin-bottom: 10px; gap: 2px; }
        .emoji-item { font-size: 30px; }
        .emoji-label { font-size: 10px; margin-top: 2px; }

        /* Button Compact */
        button#btn-submit { margin-top: 15px; padding: 10px; font-size: 15px; }
      }

      /* ----- Desktop (PC / Laptop) ----- */
      @media screen and (min-width: 769px) {
        
        /* 1. ‡∏à‡∏±‡∏î‡πÄ‡∏°‡∏ô‡∏π (Home, History, Settings) ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠‡πÄ‡∏õ‡πä‡∏∞‡πÜ */
        .nav-center {
          position: absolute;      /* ‡∏•‡∏≠‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
          left: 50%;               /* ‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 50% ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
          transform: translateX(-50%); /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏≤‡∏á‡∏û‡∏≠‡∏î‡∏µ */
          width: auto;
          justify-content: center;
        }

        /* 2. ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏£‡∏ß‡∏°‡πÄ‡∏°‡∏ô‡∏π ‡∏î‡∏±‡∏ô‡∏™‡πà‡∏ß‡∏ô User Info ‡πÑ‡∏õ "‡∏Ç‡∏ß‡∏≤‡∏™‡∏∏‡∏î" */
        .nav-collapsible {
          display: flex;
          flex: 1;                 /* ‡∏¢‡∏∑‡∏î‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ */
          justify-content: flex-end; /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏î‡∏±‡∏ô .nav-right ‡πÑ‡∏õ‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏ß‡∏≤ */
          align-items: center;
        }
      }

      /* --- Luxury Loading Spinner --- */
      .loader {
        border: 3px solid #f3f3f3; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÅ‡∏ö‡∏ö‡∏à‡∏≤‡∏á‡πÜ */
        border-top: 3px solid #20a497; /* ‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å (Theme Color) */
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 0.8s cubic-bezier(0.4, 0.0, 0.2, 1) infinite; /* ‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏°‡∏π‡∏ó */
        margin: 0 auto 15px auto; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ */
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Modal Loading ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏Ñ‡∏•‡∏µ‡∏ô */
      .loading-box {
        background: white;
        padding: 30px 50px;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 20px 60px rgba(0,0,0,0.15); /* ‡πÄ‡∏á‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏•‡∏≠‡∏¢‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }

      .loading-text {
        font-family: 'Sarabun', sans-serif;
        font-size: 18px;
        color: #555;
        font-weight: 600;
        letter-spacing: 0.5px;
      }

      .footer-message {
        color: #999;           /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô */
        font-size: 11px;       /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å */
        text-align: center;
        margin-top: 15px;
        margin-bottom: 15px;   /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏° */
        line-height: 1.4;
        font-weight: 400;
        padding: 0 10px;       /* ‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏à‡∏≠‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
      }

      /* --- Luxury Detail Modal --- */
      .detail-modal-box {
        background: #ffffff;
        width: 90%;
        max-width: 500px;
        padding: 0; /* Reset padding ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î Header ‡∏™‡∏ß‡∏¢‡πÜ */
        border-radius: 20px;
        box-shadow: 0 25px 50px rgba(0,0,0,0.25); /* ‡πÄ‡∏á‡∏≤‡∏•‡∏∂‡∏Å‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏•‡∏≠‡∏¢ */
        overflow: hidden;
        animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        text-align: left;
        position: relative;
      }

      .detail-header {
        background: linear-gradient(135deg, #20a497 0%, #15b8a6 100%);
        padding: 25px 30px;
        color: white;
        position: relative;
      }
      .detail-header h3 {
        margin: 0;
        font-family: 'Sarabun', sans-serif;
        font-size: 22px;
        font-weight: 700;
        letter-spacing: 0.5px;
      }
      .btn-close-detail {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(255,255,255,0.2);
        border: none;
        color: white;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: 0.2s;
      }
      .btn-close-detail:hover { background: rgba(255,255,255,0.4); }

      .detail-body {
        padding: 30px;
        overflow-y: auto;
        max-height: 70vh; /* ‡∏Å‡∏±‡∏ô‡∏ó‡∏∞‡∏•‡∏∏‡∏à‡∏≠‡∏ñ‡πâ‡∏≤‡∏¢‡∏≤‡∏ß‡∏°‡∏≤‡∏Å */
      }

      .detail-item {
        margin-bottom: 20px;
        border-bottom: 1px solid #f0f0f0;
        padding-bottom: 15px;
      }
      .detail-item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }

      .detail-label {
        font-size: 13px;
        color: #888;
        font-weight: 600;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .detail-value {
        font-size: 16px;
        color: #333;
        font-weight: 500;
        line-height: 1.6;
        white-space: pre-wrap; /* ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ */
        word-break: break-word;
      }
      
      /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÅ‡∏ñ‡∏ß‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏î‡πÑ‡∏î‡πâ */
      .history-table tbody tr {
        cursor: pointer;
        transition: background-color 0.2s;
      }
      .history-table tbody tr:hover {
        background-color: #eefbf9; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô‡πÜ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ä‡∏µ‡πâ */
      }
  </style>
  </head>
  <body>
    <a href="index.html" style="position:fixed; top:10px; left:10px; z-index:9999; background:rgba(0,0,0,0.5); color:white; padding:8px 12px; border-radius:20px; text-decoration:none; font-family:sans-serif; font-size:12px;">
    ‚¨Ö Home
    </a>

    <nav class="navbar" id="main-navbar" style="display: none;">
      <div class="nav-left"><span class="pyh-logo">PYH</span></div>

      <div class="hamburger" onclick="toggleMenu(this)">
        <span></span>
        <span></span>
        <span></span>
      </div>

      <div class="nav-collapsible" id="nav-collapsible">
          <div class="nav-center">
            <a class="nav-link active" onclick="switchTab('main', this); closeMenu();" id="nav-home">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
            <a class="nav-link" onclick="switchTab('history', this); closeMenu();" id="nav-history">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</a>
            <a class="nav-link" onclick="switchTab('settings', this); closeMenu();" id="nav-settings">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
          </div>
          <div class="nav-right">
            <div id="user-info-display">
              <span id="current-user">User</span><span id="current-role">(Role)</span>
            </div>
            <button class="lang-btn" onclick="toggleLanguage()">TH | EN</button>
            <button class="logout-btn" onclick="logout()" id="btn-logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
          </div>
      </div>
    </nav>

    <div class="container" id="main-container">
      
      <div id="login-section">
        <div class="login-header">
          <div class="pyh-logo login-brand">PYH</div>
          <div class="login-subtitle">SERVICE EVALUATION SYSTEM</div>
        </div>
        <div class="input-group-icon">
          <input type="text" id="username" placeholder="Username"><span class="icon-user"></span>
        </div>
        <div class="input-group-icon">
          <input type="password" id="password" placeholder="Password"><span class="icon-lock"></span>
        </div>
        <button onclick="checkLogin()" class="btn-gradient" id="btn-login">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>

      <div id="survey-section" style="display:none;">
        <div class="input-group">
          <label id="lbl-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤</label>
          <input type="text" id="realtime-clock" class="readonly-field" readonly>
        </div>
          <h2 id="survey-header" style="text-align: center; margin-top: 25px;">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h2>        
          <p id="survey-subtitle" class="survey-subtitle">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à Phuket Yacht Haven ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>
        
        <label style="text-align:center; margin-bottom:5px; display:block; margin-top: 15px;" id="lbl-sat">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</label>
        <p id="lbl-sat-sub" class="satisfaction-subtitle">‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÉ‡∏î?</p>
        <div class="emoji-container">
          <div onclick="selectEmoji(5, this)"><div class="emoji-item">ü§©</div><div class="emoji-label" id="emoji-label-5">‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°</div></div>
          <div onclick="selectEmoji(4, this)"><div class="emoji-item">üòÑ</div><div class="emoji-label" id="emoji-label-4">‡∏î‡∏µ‡∏°‡∏≤‡∏Å</div></div>
          <div onclick="selectEmoji(3, this)"><div class="emoji-item">üòê</div><div class="emoji-label" id="emoji-label-3">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div></div>
          <div onclick="selectEmoji(2, this)"><div class="emoji-item">üòï</div><div class="emoji-label" id="emoji-label-2">‡∏û‡∏≠‡πÉ‡∏ä‡πâ</div></div>
          <div onclick="selectEmoji(1, this)"><div class="emoji-item">üò´</div><div class="emoji-label" id="emoji-label-1">‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</div></div>
        </div>
        <div class="input-group">
          <label id="lbl-group">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</label>
          <select id="customer-group" onchange="toggleOtherInput()">
            <option value="" disabled selected id="opt-default">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ --</option>
            <option value="Boat Owner" id="opt-1">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠</option>
            <option value="Captain & Crew" id="opt-2">‡∏Å‡∏±‡∏õ‡∏ï‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡πÄ‡∏£‡∏∑‡∏≠</option>
            <option value="Charter Company Guest" id="opt-3">‡πÅ‡∏Ç‡∏Å‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÄ‡∏ä‡πà‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏•‡∏≥</option>
            <option value="Restaurant Guest" id="opt-4">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</option>
            <option value="Other" id="opt-5">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)</option>
          </select>
          <input type="text" id="other-specify" placeholder="‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏..." style="display:none; margin-top:10px;">
        </div>
        <div class="input-group">
          <label id="lbl-contact">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
          <p id="lbl-contact-sub" class="contact-subtitle">‡∏´‡∏≤‡∏Å‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏• ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÉ‡∏î‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á?</p>
            <input type="text" id="c-phone" class="contact-input" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
            <input type="text" id="c-line" class="contact-input" placeholder="Line ID">
            <input type="text" id="c-email" class="contact-input" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
            <input type="text" id="c-other" class="contact-input" placeholder="‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)">        
        </div>
        <div class="input-group">
          <label id="lbl-suggestion">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
          <textarea id="suggestion" rows="3" placeholder="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
        </div>
        <p id="survey-footer" class="footer-message">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞! ‡πÄ‡∏£‡∏≤‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡∏û‡∏±‡∏í‡∏ô‡∏≤ PYH ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô</p>

        <button onclick="submitForm()" id="btn-submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </div>

      <div id="history-section" style="display:none;">
        <h2 style="text-align:center; color:#333;" id="history-header">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
        <div style="overflow-x: auto;">
          <table class="history-table">
            <thead>
              <tr>
                <th id="th-date">‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤</th>
                <th id="th-sat">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</th>
                <th id="th-group">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                <th id="th-contact">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
                <th id="th-suggest">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</th>
              </tr>
            </thead>
            <tbody id="table-body"></tbody>
          </table>
          <div id="loading-msg" class="no-data" style="display:none;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
        </div>
      </div>
    </div>

    <div id="settings-container" class="settings-card" style="display:none;">
        <div class="settings-header-box">
          <h2 style="margin:0; color:#333;" id="settings-header">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
          <button class="btn-add-user" onclick="openUserModal()">
            <span id="btn-add-user-text">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
          </button>
        </div>
        <div style="overflow-x: auto;">
          <table class="history-table">
            <thead>
              <tr>
                <th id="th-u-user">Username</th>
                <th id="th-u-dept">‡πÅ‡∏ú‡∏ô‡∏Å (Department)</th>
                <th id="th-u-role">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Role)</th>
                <th style="text-align:center;" id="th-u-action">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
              </tr>
            </thead>
            <tbody id="user-table-body"></tbody>
          </table>
          <div id="loading-users" class="no-data" style="display:none;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...</div>
        </div>
    </div>

    <div id="user-modal" class="modal-overlay" style="display: none;">
      <div class="modal-box" style="text-align: left; max-width: 400px; width:90%;">
        <h3 id="user-modal-title" style="margin-top:0; margin-bottom:20px; text-align:center;">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
        <input type="hidden" id="old-username"> 
        <div class="form-row"><label id="lbl-u-user">Username</label><input type="text" id="u-username" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ"></div>
        <div class="form-row"><label id="lbl-u-pass">Password</label><input type="text" id="u-password" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"></div>
        <div class="form-row"><label id="lbl-u-dept">‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</label><input type="text" id="u-dept" placeholder="‡πÄ‡∏ä‡πà‡∏ô IT, HR, Admin"></div>
        <div class="form-row">
          <label id="lbl-u-role">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
          <select id="u-role"><option value="user">User (‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)</option><option value="admin">Admin (‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö)</option></select>
        </div>
        <div style="display:flex; gap:10px; margin-top:20px;">
          <button id="btn-save-user" class="btn-gradient" onclick="saveUser()" style="margin-top:0;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
          <button id="btn-cancel-user" class="btn-gradient" onclick="closeUserModal()" style="margin-top:0; background:#999;">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
      </div>
    </div>

    <div id="success-modal" class="modal-overlay" style="display: none;">
      <div class="modal-box">
        <div class="success-icon-ring">
          <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">
            <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
            <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
          </svg>
        </div>
        <h3 id="modal-success-text">Success!</h3>
      </div>
    </div>

    <div id="alert-modal" class="modal-overlay" style="display: none;">
      <div class="modal-box">
        <div class="warning-icon-ring"><span class="warning-mark">!</span></div>
        <h3 id="alert-title">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
        <p id="alert-message" style="color:#666; margin-top:10px;">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>
        <button class="btn-modal-ok" onclick="closeAlertModal()">‡∏ï‡∏Å‡∏•‡∏á</button>
      </div>
    </div>

    <div id="confirm-modal" class="modal-overlay" style="display: none;">
      <div class="modal-box">
        <div class="warning-icon-ring" style="border-color: #f44336;">
          <span class="warning-mark" style="color: #f44336;">?</span>
        </div>
        <h3 id="confirm-title">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö</h3>
        <p id="confirm-message" style="color:#666; margin-top:10px;">‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
        <div style="display: flex; justify-content: center; gap: 15px; margin-top: 25px;">
            <button class="btn-modal-cancel" onclick="closeConfirmModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button class="btn-modal-delete" onclick="executeDelete()">‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
      </div>
    </div>

    <div id="loading-modal" class="modal-overlay" style="display: none;">
      <div class="loading-box">
        <div class="loader"></div>
        <div id="loading-text" class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
      </div>
    </div>

    <div id="detail-modal" class="modal-overlay" style="display: none; backdrop-filter: blur(5px);">
      <div class="detail-modal-box">
        <div class="detail-header">
          <h3 id="detail-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</h3>
          <button class="btn-close-detail" onclick="closeDetailModal()">‚úï</button>
        </div>
        <div class="detail-body">
          
          <div class="detail-item">
            <div class="detail-label" id="lbl-d-date">‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤ (Date & Time)</div>
            <div class="detail-value" id="d-date"></div>
          </div>

          <div class="detail-item">
            <div class="detail-label" id="lbl-d-sat">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à (Satisfaction)</div>
            <div class="detail-value" id="d-sat" style="color:#20a497; font-weight:bold;"></div>
          </div>

          <div class="detail-item">
            <div class="detail-label" id="lbl-d-group">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Customer Group)</div>
            <div class="detail-value" id="d-group"></div>
          </div>

          <div class="detail-item">
            <div class="detail-label" id="lbl-d-contact">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (Contact)</div>
            <div class="detail-value" id="d-contact"></div>
          </div>

          <div class="detail-item">
            <div class="detail-label" id="lbl-d-suggest">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ (Suggestion)</div>
            <div class="detail-value" id="d-suggest" style="font-style: italic; color:#555;"></div>
          </div>

        </div>
      </div>
    </div>

    <script>

      // ==========================================
      // üî¥ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API (Assessment)
      // ==========================================
      const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwL7bpluhy_QVwlhpgJ9ghnJ9k2ux1VvhVG2ssFG9SLM3wIzwWaSXDsEO2Rkn2VbxYJ/exec"; // üëà ‡πÄ‡∏≠‡∏≤ URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠ 2.1 ‡∏°‡∏≤‡πÉ‡∏™‡πà

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á object google.script.run ‡∏à‡∏≥‡∏•‡∏≠‡∏á
      const google = {
        script: {
          run: {
            withSuccessHandler: function(onSuccess) {
              this._onSuccess = onSuccess;
              return this;
            },
            withFailureHandler: function(onFailure) {
              this._onFailure = onFailure;
              return this;
            },
            _call: function(fnName, args) {
              fetch(SCRIPT_URL, {
                method: 'POST',
                headers: { "Content-Type": "text/plain;charset=utf-8" },
                body: JSON.stringify({ action: fnName, args: args })
              })
              .then(res => res.json())
              .then(data => {
                if(this._onSuccess) this._onSuccess(data);
              })
              .catch(err => {
                console.error("API Error:", err);
                if(this._onFailure) this._onFailure(err);
              });
            },
            // Mapping ‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            loginUser: function(...args) { this._call('loginUser', args); },
            saveData: function(...args) { this._call('saveData', args); },
            getHistoryData: function(...args) { this._call('getHistoryData', args); },
            getAllUsers: function(...args) { this._call('getAllUsers', args); },
            saveUserData: function(...args) { this._call('saveUserData', args); },
            deleteUser: function(...args) { this._call('deleteUser', args); }
          }
        }
      };
      
      // --- Global Variables ---
      let currentLang = 'th'; 
      let cachedUsersData = null; 
      let cachedHistoryData = null; // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
      let pendingDeleteUser = ""; 
      let currentUserRole = ""; 

      // --- Translations ---
      const translations = {
        th: {
          nav_home: "‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å", 
          nav_history: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥", 
          nav_settings: "‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤", 
          btn_logout: "‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö",
          btn_login: "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö", 
          
          // 1. ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
          survey_header: "‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", 
          survey_subtitle: "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à Phuket Yacht Haven ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏•‡∏∞‡∏°‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô", 

          lbl_date: "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤",
          
          // 2. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
          lbl_sat: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", 
          lbl_sat_sub: "‡∏ó‡πà‡∏≤‡∏ô‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÉ‡∏î?",

          lbl_group: "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", 
          
          // 3. ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
          lbl_contact: "‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
          lbl_contact_sub: "‡∏´‡∏≤‡∏Å‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏ú‡∏• ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡πà‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÉ‡∏î‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á?",

          lbl_suggestion: "‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)", 
          
          // 4. ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          footer_msg: "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞! ‡πÄ‡∏£‡∏≤‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ô‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏≥‡πÑ‡∏õ‡∏û‡∏±‡∏í‡∏ô‡∏≤ PYH ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏¢‡∏¥‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô",

          btn_submit: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
          btn_saving: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...",
          msg_saving: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...",
          msg_saving_user: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ...",
          msg_deleting_user: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...",
          
          emoji_5: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°", 
          emoji_4: "‡∏î‡∏µ‡∏°‡∏≤‡∏Å", 
          emoji_3: "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", 
          emoji_2: "‡∏û‡∏≠‡πÉ‡∏ä‡πâ", 
          emoji_1: "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á",
          
          opt_default: "-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ --", 
          opt_1: "‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠", 
          opt_2: "‡∏Å‡∏±‡∏õ‡∏ï‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡∏π‡∏Å‡πÄ‡∏£‡∏∑‡∏≠", 
          opt_3: "‡πÅ‡∏Ç‡∏Å‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÄ‡∏ä‡πà‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏•‡∏≥",
          opt_4: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£",
          opt_5: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)",
          
          history_header: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", 
          th_date: "‡∏ß‡∏±‡∏ô-‡πÄ‡∏ß‡∏•‡∏≤", 
          th_sat: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à", 
          th_group: "‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤",
          th_contact: "‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠", 
          th_suggest: "‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞", 
          loading: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...", 
          no_data: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",
          modal_success: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!", 
          
          ph_contact: "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£ / Line ID / Email", 
          ph_suggestion: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°...",
          ph_user: "Username", 
          ph_pass: "Password",
          
          // Placeholder ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÅ‡∏•‡∏∞ Contact
          ph_other: "‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î...",
          ph_c_phone: "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå",
          ph_c_line: "Line ID",
          ph_c_email: "‡∏≠‡∏µ‡πÄ‡∏°‡∏•",
          ph_c_other: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏)",

          settings_header: "‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", 
          btn_add_user: "+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô", 
          th_u_user: "Username", 
          th_u_dept: "‡πÅ‡∏ú‡∏ô‡∏Å (Department)",
          th_u_role: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Role)", 
          th_u_action: "‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£", 
          loading_users: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...", 
          no_users: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
          lbl_u_user: "Username", 
          lbl_u_pass: "Password", 
          lbl_u_dept: "‡πÅ‡∏ú‡∏ô‡∏Å / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î", 
          lbl_u_role: "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
          ph_u_user: "‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ", 
          ph_u_pass: "‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô", 
          ph_u_dept: "‡πÄ‡∏ä‡πà‡∏ô IT, HR, Admin",
          btn_save: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å", 
          btn_cancel: "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å", 
          role_user: "User (‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)", 
          role_admin: "Admin (‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö)",
          btn_edit: "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç", 
          btn_delete: "‡∏•‡∏ö",
          role_display_admin: "‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö", 
          role_display_user: "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ"
        },
        en: {
          nav_home: "Home", 
          nav_history: "History", 
          nav_settings: "Settings", 
          btn_logout: "Logout",
          btn_login: "Login", 
          survey_header: "PYH Overall Experience Survey",
          survey_subtitle: "Thank you for choosing Phuket Yacht Haven. Your feedback helps us improve and deliver a better marina experience.",
          lbl_date: "Date & Time",
          lbl_sat: "Overall Satisfaction", 
          lbl_sat_sub: "How would you rate your overall experience during your stay?",
          lbl_group: "Customer Group", 
          lbl_contact: "Contact Information (Optional)",
          lbl_contact_sub: "If follow-up is needed, how may we contact you?",
          ph_c_phone: "Phone",
          ph_c_line: "Line ID",
          ph_c_email: "Email",
          ph_c_other: "Other (please specify)",
          lbl_suggestion: "Suggestion (Optional)",
          footer_msg: "Thank you! We appreciate your time and value your feedback as we continue enhancing the PYH experience.",
          btn_submit: "Save Data",
          btn_saving: "Saving...",
          msg_saving: "Saving data...",
          msg_saving_user: "Saving user data...",
          msg_deleting_user: "Deleting user...",
          emoji_5: "Excellent", 
          emoji_4: "Good", 
          emoji_3: "Average", 
          emoji_2: "Fair", 
          emoji_1: "Needs Improvement",
          opt_default: "-- Please select your customer category: --", 
          opt_1: "Boat Owner", 
          opt_2: "Captain & Crew", 
          opt_3: "Charter Company Guest",
          opt_4: "Restaurant Guest",
          opt_5: "Other (please specify)",
          history_header: "Submission History", 
          th_date: "Date-Time", 
          th_sat: "Satisfaction", 
          th_group: "Group",
          th_contact: "Contact", 
          th_suggest: "Suggestion", 
          loading: "Loading data...", 
          no_data: "No history found",
          modal_success: "Success!", 
          ph_contact: "Phone / Line ID / Email",
          ph_other: "Please specify details...",
          ph_suggestion: "Please share your additional comments...",
          ph_user: "Username", 
          ph_pass: "Password",
          settings_header: "User Management", 
          btn_add_user: "+ Add User", 
          th_u_user: "Username", 
          th_u_dept: "Department",
          th_u_role: "Role", 
          th_u_action: "Actions", 
          loading_users: "Loading users...", 
          no_users: "No users found",
          lbl_u_user: "Username", 
          lbl_u_pass: "Password", 
          lbl_u_dept: "Department", 
          lbl_u_role: "Role",
          ph_u_user: "Enter username", 
          ph_u_pass: "Enter password", 
          ph_u_dept: "e.g. IT, HR",
          btn_save: "Save", 
          btn_cancel: "Cancel", 
          role_user: "User", 
          role_admin: "Admin",
          btn_edit: "Edit", 
          btn_delete: "Delete",
          role_display_admin: "Administrator", 
          role_display_user: "General User"
        }
      };

      // --- Core Functions (Language, Clock, Roles) ---
      function toggleLanguage() {
        currentLang = (currentLang === 'th') ? 'en' : 'th';
        updateLanguage();
        if(document.getElementById('settings-container').style.display === 'block') {
            loadUsers(false);
        }
      }

      function updateLanguage() {
        const t = translations[currentLang];
        // Mapping IDs to translations
        const ids = [
            'nav-home', 'nav-history', 'nav-settings', 'btn-logout', 'btn-login', 
            'survey-header', 'lbl-date', 'lbl-sat', 'lbl-group', 'lbl-contact', 'lbl-suggestion', 'btn-submit',
            'emoji-label-5', 'emoji-label-4', 'emoji-label-3', 'emoji-label-2', 'emoji-label-1',
            'opt-default', 'opt-1', 'opt-2', 'opt-3',
            'history-header', 'th-date', 'th-sat', 'th-group', 'th-contact', 'th-suggest', 'modal-success-text',
            'settings-header', 'btn-add-user-text', 'th-u-user', 'th-u-dept', 'th-u-role', 'th-u-action',
            'lbl-u-user', 'lbl-u-pass', 'lbl-u-dept', 'lbl-u-role', 'btn-save-user', 'btn-cancel-user'
        ];
        
        document.getElementById('nav-home').textContent = t.nav_home;
        document.getElementById('nav-history').textContent = t.nav_history;
        document.getElementById('nav-settings').textContent = t.nav_settings;
        document.getElementById('btn-logout').textContent = t.btn_logout;
        document.getElementById('btn-login').textContent = t.btn_login;
        
        document.getElementById('survey-header').textContent = t.survey_header;

        var subTitleEl = document.getElementById('survey-subtitle');
        subTitleEl.textContent = t.survey_subtitle || "";
        // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡πÄ‡∏ä‡πà‡∏ô ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢) ‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô element ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°
        subTitleEl.style.display = (t.survey_subtitle) ? "block" : "none";

        document.getElementById('lbl-date').textContent = t.lbl_date;
        document.getElementById('lbl-sat').textContent = t.lbl_sat;

        var satSubEl = document.getElementById('lbl-sat-sub');
        satSubEl.textContent = t.lbl_sat_sub || "";
        satSubEl.style.display = (t.lbl_sat_sub) ? "block" : "none";

        document.getElementById('lbl-group').textContent = t.lbl_group;
        document.getElementById('lbl-contact').textContent = t.lbl_contact;

        var contactSub = document.getElementById('lbl-contact-sub');
        contactSub.textContent = t.lbl_contact_sub || "";
        contactSub.style.display = (t.lbl_contact_sub) ? "block" : "none";

        document.getElementById('c-phone').placeholder = t.ph_c_phone;
        document.getElementById('c-line').placeholder = t.ph_c_line;
        document.getElementById('c-email').placeholder = t.ph_c_email;
        document.getElementById('c-other').placeholder = t.ph_c_other;

        document.getElementById('lbl-suggestion').textContent = t.lbl_suggestion;

        var footerEl = document.getElementById('survey-footer');
        footerEl.textContent = t.footer_msg || "";
        // ‡∏ã‡πà‡∏≠‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡πÄ‡∏ä‡πà‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)
        footerEl.style.display = (t.footer_msg) ? "block" : "none";
        
        document.getElementById('btn-submit').textContent = t.btn_submit;
        
        document.getElementById('history-header').textContent = t.history_header;
        document.getElementById('th-date').textContent = t.th_date;
        document.getElementById('th-sat').textContent = t.th_sat;
        document.getElementById('th-group').textContent = t.th_group;
        document.getElementById('th-contact').textContent = t.th_contact;
        document.getElementById('th-suggest').textContent = t.th_suggest;
        
        document.getElementById('emoji-label-5').textContent = t.emoji_5;
        document.getElementById('emoji-label-4').textContent = t.emoji_4;
        document.getElementById('emoji-label-3').textContent = t.emoji_3;
        document.getElementById('emoji-label-2').textContent = t.emoji_2;
        document.getElementById('emoji-label-1').textContent = t.emoji_1;
        
        document.getElementById('opt-default').textContent = t.opt_default;
        document.getElementById('opt-1').textContent = t.opt_1;
        document.getElementById('opt-2').textContent = t.opt_2;
        document.getElementById('opt-3').textContent = t.opt_3;
        document.getElementById('opt-4').textContent = t.opt_4;
        document.getElementById('opt-5').textContent = t.opt_5;
        
        document.getElementById('settings-header').textContent = t.settings_header;
        document.getElementById('btn-add-user-text').textContent = t.btn_add_user;
        document.getElementById('th-u-user').textContent = t.th_u_user;
        document.getElementById('th-u-dept').textContent = t.th_u_dept;
        document.getElementById('th-u-role').textContent = t.th_u_role;
        document.getElementById('th-u-action').textContent = t.th_u_action;
        document.getElementById('lbl-u-user').textContent = t.lbl_u_user;
        document.getElementById('lbl-u-pass').textContent = t.lbl_u_pass;
        document.getElementById('lbl-u-dept').textContent = t.lbl_u_dept;
        document.getElementById('lbl-u-role').textContent = t.lbl_u_role;
        document.getElementById('btn-save-user').textContent = t.btn_save;
        document.getElementById('btn-cancel-user').textContent = t.btn_cancel;
        document.getElementById('modal-success-text').textContent = t.modal_success;

        document.getElementById('username').placeholder = t.ph_user;
        document.getElementById('password').placeholder = t.ph_pass;
        document.getElementById('suggestion').placeholder = t.ph_suggestion;
        document.getElementById('other-specify').placeholder = t.ph_other;
        document.getElementById('u-username').placeholder = t.ph_u_user;
        document.getElementById('u-password').placeholder = t.ph_u_pass;
        document.getElementById('u-dept').placeholder = t.ph_u_dept;
        
        updateTime();
        updateRoleText();
      }

      function updateRoleText() {
        if (!currentUserRole) return;
        const t = translations[currentLang];
        const displayRole = (currentUserRole === 'admin') ? t.role_display_admin : t.role_display_user;
        document.getElementById('current-role').textContent = "(Role: " + displayRole + ")";
      }

      // --- Hamburger Menu Logic ---
      function toggleMenu(btn) {
        btn.classList.toggle('open');
        var menu = document.getElementById('nav-collapsible');
        menu.classList.toggle('active');
      }

      function closeMenu() {
        var menu = document.getElementById('nav-collapsible');
        var btn = document.querySelector('.hamburger');
        if (menu.classList.contains('active')) {
            menu.classList.remove('active');
            btn.classList.remove('open');
        }
      }

      // --- Login & Navigation Logic ---
      document.getElementById("password").addEventListener("keypress", function(event) {
        if (event.key === "Enter") checkLogin();
      });

      function checkLogin() {
        var user = document.getElementById('username').value;
        var pass = document.getElementById('password').value;
        
        if (!user || !pass) {
           showCustomAlert('Username and Password required');
           return;
        }

        var btn = document.getElementById('btn-login');
        var originalText = btn.textContent;
        btn.textContent = "Checking...";
        btn.disabled = true;

        google.script.run.withSuccessHandler(function(result) {
          btn.textContent = originalText;
          btn.disabled = false;

          if (result.success) {
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('currentUser', result.username);
            localStorage.setItem('currentRole', result.role);

            document.getElementById('login-section').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            document.getElementById('survey-section').style.display = 'block';
            document.getElementById('main-navbar').style.display = 'flex';
            
            document.getElementById('current-user').textContent = result.username;
            currentUserRole = result.role; 
            updateRoleText(); 

            if (result.role !== 'admin') {
                document.getElementById('nav-settings').style.display = 'none';
            } else {
                document.getElementById('nav-settings').style.display = 'inline-block';
            }

            startClock();

            let lastTab = localStorage.getItem('currentTab') || 'main';
            let navId = 'nav-home';
            if(lastTab === 'history') navId = 'nav-history';
            if(lastTab === 'settings') navId = 'nav-settings';

            document.body.style.overflowY = "scroll";
            document.body.style.height = "auto";
            document.body.style.alignItems = "flex-start";
            document.body.style.paddingTop = "120px";
            document.body.style.paddingBottom = "50px";
            document.querySelector('.container').style.maxWidth = "700px";

            switchTab(lastTab, document.getElementById(navId));
            
            preloadUsersData();
          } else {
            showCustomAlert('Invalid Username or Password!');
          }
        }).loginUser(user, pass);
        loadHistoryData(true);
      }

      function logout() {

        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('currentUser');
        localStorage.removeItem('currentRole');
        localStorage.removeItem('currentTab');

        document.getElementById('survey-section').style.display = 'none';
        document.getElementById('history-section').style.display = 'none';
        document.getElementById('settings-container').style.display = 'none';
        document.getElementById('main-container').style.display = 'block';
        document.getElementById('login-section').style.display = 'block';
        document.getElementById('main-navbar').style.display = 'none';
        document.getElementById('username').value = "";
        document.getElementById('password').value = "";
        resetSurveyForm();
        
        document.body.style.overflow = "hidden";
        document.body.style.height = "100vh";
        document.body.style.alignItems = "center";
        document.body.style.paddingTop = "0";
        document.body.style.paddingBottom = "0";
        document.querySelector('.container').style.maxWidth = "380px";
        
        closeMenu();
        
        cachedUsersData = null;
        currentUserRole = "";
      }

      function switchTab(tabName, linkElement) {

        localStorage.setItem('currentTab', tabName);
        document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
        if (linkElement) linkElement.classList.add('active');
        
        document.getElementById('survey-section').style.display = 'none';
        document.getElementById('history-section').style.display = 'none';
        document.getElementById('main-container').style.display = 'none';
        document.getElementById('settings-container').style.display = 'none';
        
        if (tabName === 'main') {
          document.getElementById('main-container').style.display = 'block';
          document.getElementById('survey-section').style.display = 'block';
        } else if (tabName === 'history') {
          document.getElementById('main-container').style.display = 'block';
          document.getElementById('history-section').style.display = 'block';
          loadHistoryData();
        } else if (tabName === 'settings') {
          document.getElementById('settings-container').style.display = 'block';
          loadUsers(false);
        }
      }

      // --- User Management Functions ---
      function preloadUsersData() {
        google.script.run.withSuccessHandler(function(users) { cachedUsersData = users; }).getAllUsers();
      }

      function loadUsers(forceRefresh) {
        var tbody = document.getElementById('user-table-body');
        var loading = document.getElementById('loading-users');
        if (cachedUsersData && !forceRefresh) { renderUserTable(cachedUsersData); return; }
        tbody.innerHTML = ""; loading.style.display = "block"; loading.textContent = translations[currentLang].loading_users;
        google.script.run.withSuccessHandler(function(users) {
          cachedUsersData = users; renderUserTable(users);
        }).getAllUsers();
      }

      function renderUserTable(users) {
        var tbody = document.getElementById('user-table-body');
        var loading = document.getElementById('loading-users');
        loading.style.display = "none";
        if (!users || users.length === 0) {
          loading.textContent = translations[currentLang].no_users; loading.style.display = "block"; tbody.innerHTML = ""; return;
        }
        var html = "";
        const t = translations[currentLang];
        users.forEach(function(u) {
          html += "<tr>";
          html += "<td>" + u[0] + "</td><td>" + u[2] + "</td>";
          var roleBadge = u[3] === 'admin' ? `<span style="color:#20a497; font-weight:bold;">${t.role_admin}</span>` : t.role_user;
          html += "<td>" + roleBadge + "</td>";
          html += '<td style="text-align:center;">';
          html += `<button class="action-btn btn-edit" onclick="editUser('${u[0]}', '${u[1]}', '${u[2]}', '${u[3]}')">${t.btn_edit}</button>`;
          var currentUser = document.getElementById('current-user').textContent;
          if (u[0] !== currentUser) {
             html += `<button class="action-btn btn-delete" onclick="deleteUserFunc('${u[0]}')">${t.btn_delete}</button>`;
          }
          html += '</td></tr>';
        });
        tbody.innerHTML = html;
      }

      function openUserModal() {
        document.getElementById('user-modal').style.display = 'flex';
        document.getElementById('user-modal-title').textContent = translations[currentLang].btn_add_user.replace("+ ", "");
        document.getElementById('old-username').value = ""; 
        document.getElementById('u-username').value = "";
        document.getElementById('u-password').value = "";
        document.getElementById('u-dept').value = "";
        document.getElementById('u-role').value = "user";
        document.getElementById('u-username').disabled = false;
      }

      function editUser(user, pass, dept, role) {
        document.getElementById('user-modal').style.display = 'flex';
        const t = translations[currentLang];
        document.getElementById('user-modal-title').textContent = t.btn_edit + " User";
        document.getElementById('old-username').value = user;
        document.getElementById('u-username').value = user;
        document.getElementById('u-password').value = pass;
        document.getElementById('u-dept').value = dept;
        document.getElementById('u-role').value = role;
        document.getElementById('u-username').disabled = true; 
      }

      function closeUserModal() { document.getElementById('user-modal').style.display = 'none'; }

      function saveUser() {
        var formData = {
          oldUsername: document.getElementById('old-username').value,
          username: document.getElementById('u-username').value,
          password: document.getElementById('u-password').value,
          department: document.getElementById('u-dept').value,
          role: document.getElementById('u-role').value
        };
        if(!formData.username || !formData.password) { 
          showCustomAlert("Username/Password required"); 
          return; 
          }
          // 1. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Loading Modal ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞
          showLoadingModal(translations[currentLang].msg_saving_user);
          
          // 2. ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏° Save ‡∏Å‡∏±‡∏ô‡∏Å‡∏î‡∏ã‡πâ‡∏≥
          var btnSave = document.getElementById('btn-save-user');
          btnSave.disabled = true;

          google.script.run.withSuccessHandler(function(res) {
            // 3. ‡∏õ‡∏¥‡∏î Loading Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à
            closeLoadingModal();
            btnSave.disabled = false; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°

            if (res === 'Duplicate') { 
              showCustomAlert("Username already exists"); 
            } else { 
              closeUserModal(); 
              showSuccessModal(); 
              loadUsers(true); 
            }
          }).saveUserData(formData);
        }

      function deleteUserFunc(username) {
        pendingDeleteUser = username; 
        const isThai = currentLang === 'th';
        document.getElementById('confirm-title').textContent = isThai ? "‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö" : "Confirm Deletion";
        document.getElementById('confirm-message').textContent = (isThai ? "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: " : "Delete user: ") + username + " ?";
        document.getElementById('confirm-modal').style.display = 'flex';
      }

      function executeDelete() {
        if (!pendingDeleteUser) return;
        const userToDelete = pendingDeleteUser; 
        closeConfirmModal(); 
        // 1. ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Loading Modal ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö..."
        showLoadingModal(translations[currentLang].msg_deleting_user);

        google.script.run.withSuccessHandler(function(){ 
          // 2. ‡∏õ‡∏¥‡∏î Loading Modal
          closeLoadingModal();
          
          loadUsers(true); 
          showSuccessModal(); 
        }).deleteUser(userToDelete);      
      }

      function closeConfirmModal() {
        document.getElementById('confirm-modal').style.display = 'none';
        pendingDeleteUser = "";
      }

      // --- History & Survey Functions ---
      function loadHistoryData(forceRefresh = false) { // ‡∏£‡∏±‡∏ö‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå forceRefresh ‡πÄ‡∏û‡∏¥‡πà‡∏°
        var tbody = document.getElementById('table-body');
        var loading = document.getElementById('loading-msg');
        
        // 1. ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏Ñ‡∏ä‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà -> ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏•‡∏¢ ‡πÄ‡∏£‡πá‡∏ß‡∏õ‡∏£‡∏π‡πä‡∏î!
        if (cachedHistoryData && !forceRefresh) {
            renderHistoryTable(cachedHistoryData);
            return; 
        }

        tbody.innerHTML = ""; 
        loading.style.display = "block"; 
        loading.textContent = translations[currentLang].loading;

        google.script.run.withFailureHandler(function(error) {
            loading.textContent = "Error: " + error.message;
        }).withSuccessHandler(function(data) {
          loading.style.display = "none";
          
          // 2. ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÅ‡∏Ñ‡∏ä‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤
          cachedHistoryData = data; 
          
          renderHistoryTable(data);
        }).getHistoryData();
      }

      function renderHistoryTable(data) {
        var tbody = document.getElementById('table-body');
        var loading = document.getElementById('loading-msg');
        
        if (!data || data.length === 0) { 
            loading.textContent = translations[currentLang].no_data; 
            loading.style.display = "block"; 
            tbody.innerHTML = "";
            return; 
        }
        
        var html = "";
        // Mapping Emoji ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (Optional: ‡πÉ‡∏™‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏û)
        const mapSat = { 
          "1.‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°": "5.‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°", "2.‡∏î‡∏µ‡∏°‡∏≤‡∏Å": "4.‡∏î‡∏µ‡∏°‡∏≤‡∏Å", 
          "3.‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á": "3.‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", "4.‡∏û‡∏≠‡πÉ‡∏ä‡πâ": "2.‡∏û‡∏≠‡πÉ‡∏ä‡πâ", "5.‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á": "1.‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á"
        };

        data.forEach(function(row) {
        var rowDataSafe = JSON.stringify(row).replace(/"/g, '&quot;');
          // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏µ Background ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
          // ‡πÅ‡∏ï‡πà‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏≠‡∏≤‡πÅ‡∏Ñ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡πà‡∏≠‡∏ô
          html += `<tr onclick="openDetailModal(${rowDataSafe})">`;
          html += "<td>" + (row[0] || "") + "</td>";
          html += "<td>" + (row[1] || "") + "</td>"; // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
          html += "<td>" + (row[2] || "") + "</td>";
          html += "<td>" + (row[3] || "") + "</td>";
          html += "<td>" + (row[4] || "") + "</td>";
          html += "</tr>";
        });
        tbody.innerHTML = html;
      }

      function showSuccessModal() {
        var modal = document.getElementById('success-modal');
        modal.style.display = 'flex';
        setTimeout(function() { modal.style.display = 'none'; }, 2000); 
      }
      function showCustomAlert(message) {
        var modal = document.getElementById('alert-modal');
        document.getElementById('alert-message').textContent = message;
        modal.style.display = 'flex';
      }
      function closeAlertModal() { document.getElementById('alert-modal').style.display = 'none'; }

      function resetSurveyForm() {
          document.getElementById('c-phone').value = "";
          document.getElementById('c-line').value = "";
          document.getElementById('c-email').value = "";
          document.getElementById('c-other').value = "";
          document.getElementById('suggestion').value = "";
          document.getElementById('customer-group').selectedIndex = 0;

          var items = document.querySelectorAll('.emoji-item'); 
          items.forEach(el => el.classList.remove('active'));
          selectedScore = 0; selectedText = "";
      }
      function startClock() { updateTime(); setInterval(updateTime, 1000); }
      function updateTime() {
        var now = new Date();
        var locale = (currentLang === 'th') ? 'th-TH' : 'en-US';
        var dateString = now.toLocaleString(locale, { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' });
        document.getElementById('realtime-clock').value = dateString;
      }
      var selectedScore = 0; var selectedText = "";
      function selectEmoji(score, element) {
        var items = document.querySelectorAll('.emoji-item'); 
        items.forEach(el => el.classList.remove('active'));
        element.querySelector('.emoji-item').classList.add('active');
        
        // ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏Ñ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏û‡∏≠ (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ‡∏´‡∏≤‡∏ï‡∏≠‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å)
        selectedScore = score;
      }

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏≠‡∏∑‡πà‡∏ô‡πÜ" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      function toggleOtherInput() {
        var group = document.getElementById('customer-group').value;
        var otherInput = document.getElementById('other-specify');
        
        // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏∑‡∏≠ "Other" ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å
        if (group === 'Other') {
          otherInput.style.display = 'block';
          // ‡πÇ‡∏ü‡∏Å‡∏±‡∏™‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å
          otherInput.focus(); 
        } else {
          otherInput.style.display = 'none';
          otherInput.value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏∑‡πà‡∏ô
        }
      }

      function submitForm() {
          // 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
          if (selectedScore === 0) { 
            // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            var msg = (currentLang === 'th') ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à' : 'Please select satisfaction level';
            showCustomAlert(msg); 
            return;
          }

          // 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
          var groupSelect = document.getElementById('customer-group');
          var selectedOption = groupSelect.options[groupSelect.selectedIndex];
          var groupValue = groupSelect.value; // ‡∏Ñ‡πà‡∏≤ value ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (‡πÄ‡∏ä‡πà‡∏ô Boat Owner)

          if (groupValue === "") { 
            var msg = (currentLang === 'th') ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤' : 'Please select customer category';
            showCustomAlert(msg);
            return; 
          }

          // --- Logic ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏©‡∏≤: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ---
          var finalGroupText = "";
          
          if (groupValue === "Other") {
              // ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
              var specifiedText = document.getElementById('other-specify').value.trim();
              if (specifiedText === "") {
                  var msg = (currentLang === 'th') ? '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤' : 'Please specify customer details';
                  showCustomAlert(msg);
                  document.getElementById('other-specify').focus();
                  return;
              }
              // ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤ (‡∏≠‡∏∑‡πà‡∏ô‡πÜ: ... / Other: ...)
              var prefix = (currentLang === 'th') ? "‡∏≠‡∏∑‡πà‡∏ô‡πÜ: " : "Other: ";
              finalGroupText = prefix + specifiedText;
          } else {
              // ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•‡∏à‡∏≤‡∏Å translations ‡∏ï‡∏≤‡∏° ID ‡∏Ç‡∏≠‡∏á option)
              // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ID "opt-1" -> ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô key "opt_1" ‡πÉ‡∏ô translations
              var translationKey = selectedOption.id.replace("-", "_"); // ‡πÅ‡∏õ‡∏•‡∏á opt-1 ‡πÄ‡∏õ‡πá‡∏ô opt_1
              if (translations[currentLang][translationKey]) {
                  finalGroupText = translations[currentLang][translationKey];
              } else {
                  finalGroupText = groupValue; // ‡∏ñ‡πâ‡∏≤‡∏´‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°
              }
          }

          // --- Logic ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏©‡∏≤: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à ---
          // ‡∏™‡∏£‡πâ‡∏≤‡∏á Mapping ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤
          var satMap = {
            th: { 5: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°", 4: "‡∏î‡∏µ‡∏°‡∏≤‡∏Å", 3: "‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á", 2: "‡∏û‡∏≠‡πÉ‡∏ä‡πâ", 1: "‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á" },
            en: { 5: "Excellent", 4: "Good", 3: "Average", 2: "Fair", 1: "Needs Improvement" }
          };
          var finalSatText = satMap[currentLang][selectedScore];

          // --- Logic ‡πÅ‡∏õ‡∏•‡∏á‡∏†‡∏≤‡∏©‡∏≤: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ---
          var cPhone = document.getElementById('c-phone').value.trim();
          var cLine = document.getElementById('c-line').value.trim();
          var cEmail = document.getElementById('c-email').value.trim();
          var cOther = document.getElementById('c-other').value.trim();

          var contactArray = [];
          // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ (Prefix) ‡∏ï‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤
          var pPhone = (currentLang === 'th') ? "‡πÇ‡∏ó‡∏£: " : "Phone: ";
          var pLine  = "Line: "; // ‡∏ó‡∏±‡∏ö‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô
          var pEmail = (currentLang === 'th') ? "‡∏≠‡∏µ‡πÄ‡∏°‡∏•: " : "Email: ";
          var pOther = (currentLang === 'th') ? "‡∏≠‡∏∑‡πà‡∏ô‡πÜ: " : "Other: ";

          if(cPhone) contactArray.push(pPhone + cPhone);
          if(cLine)  contactArray.push(pLine + cLine);
          if(cEmail) contactArray.push(pEmail + cEmail);
          if(cOther) contactArray.push(pOther + cOther);
          
          var combinedContact = contactArray.join(", ");

          // 3. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          showLoadingModal();
          var btn = document.getElementById('btn-submit');
          btn.disabled = true;

          var formData = { 
              satisfaction: finalSatText,  // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
              customerGroup: finalGroupText, // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
              contact: combinedContact,      // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
              suggestion: document.getElementById('suggestion').value 
          };

          google.script.run.withSuccessHandler(function(response) {
            closeLoadingModal();
            showSuccessModal(); 
            resetSurveyForm(); 
            
            btn.textContent = translations[currentLang].btn_submit; 
            btn.disabled = false;
            btn.style.cursor = 'pointer';

            cachedHistoryData = null; 
            loadHistoryData(true);

          }).saveData(formData);
        }

      // --- [‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà] ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Session ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ---
      function checkSession() {
          const isLoggedIn = localStorage.getItem('isLoggedIn');
          
          if (isLoggedIn === 'true') {
              const user = localStorage.getItem('currentUser');
              const role = localStorage.getItem('currentRole');
              const tab = localStorage.getItem('currentTab') || 'main';

              // 1. ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Global
              currentUserRole = role;
              
              // 2. ‡∏õ‡∏£‡∏±‡∏ö UI ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
              document.getElementById('login-section').style.display = 'none';
              document.getElementById('main-container').style.display = 'block';
              document.getElementById('main-navbar').style.display = 'flex';
              document.getElementById('current-user').textContent = user;
              
              updateRoleText();

              // 3. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π Admin
              if (role === 'admin') {
                  document.getElementById('nav-settings').style.display = 'inline-block';
              } else {
                  document.getElementById('nav-settings').style.display = 'none';
              }

              // 4. ‡∏õ‡∏£‡∏±‡∏ö Style ‡∏Ç‡∏≠‡∏á Body
              document.body.style.overflowY = "scroll";
              document.body.style.height = "auto";
              document.body.style.alignItems = "flex-start";
              document.body.style.paddingTop = "120px";
              document.body.style.paddingBottom = "50px";
              document.querySelector('.container').style.maxWidth = "700px";

              // 5. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
              startClock();
              preloadUsersData();

              // 6. ‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
              let navId = 'nav-home';
              if (tab === 'history') navId = 'nav-history';
              if (tab === 'settings' && role === 'admin') navId = 'nav-settings'; // ‡πÄ‡∏ä‡πá‡∏Ñ role ‡∏Å‡∏±‡∏ô‡∏û‡∏•‡∏≤‡∏î
              
              // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å switchTab (‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏î)
              switchTab(tab, document.getElementById(navId));
              
          } else {
              // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ Session ‡∏Å‡πá‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤ Login ‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥
          }
      }

      // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      window.onload = function() {
          checkSession();
          updateLanguage(); // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
      };

      function showLoadingModal(customText) {
        var textToShow = customText || translations[currentLang].msg_saving;

        document.getElementById('loading-text').textContent = textToShow;
        document.getElementById('loading-modal').style.display = 'flex';
      }

      function closeLoadingModal() {
        document.getElementById('loading-modal').style.display = 'none';
      }

      // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
      function openDetailModal(data) {
        // data ‡∏Ñ‡∏∑‡∏≠ Array [Timestamp, Satisfaction, Group, Contact, Suggestion]
        
        // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô Modal
        document.getElementById('d-date').textContent = data[0] || "-";
        document.getElementById('d-sat').textContent = data[1] || "-";
        document.getElementById('d-group').textContent = data[2] || "-";
        
        // Contact (‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡∏™‡∏ß‡∏¢‡πÜ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ comma)
        var contactText = data[3] || "-";
        document.getElementById('d-contact').textContent = contactText.replace(/, /g, '\n'); 

        document.getElementById('d-suggest').textContent = (data[4] && data[4] !== "") ? data[4] : "- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ -";

        // ‡πÅ‡∏™‡∏î‡∏á Modal
        document.getElementById('detail-modal').style.display = 'flex';
      }

      function closeDetailModal() {
        document.getElementById('detail-modal').style.display = 'none';
      }
      
      // ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÜ ‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å
      document.getElementById('detail-modal').addEventListener('click', function(e) {
          if (e.target === this) {
              closeDetailModal();
          }
      });
    </script>
  </body>
</html>

